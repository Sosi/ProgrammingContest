<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td>Fox Ciel learned a new skill of splitting! She can split into (<b>S</b> + <b>L</b> + <b>R</b>) foxes each time.
Now she is practicing this skill on an infinite horizontal plane. At the beginning, Fox Ciel is the only fox on the plane.
She stands at the point (0,0) and she is facing the point (1,0).
<br></br>
<br></br>
<br></br>
There will be <b>n</b> steps.
In each step, each fox on the plane will split into exactly (<b>S</b> + <b>L</b> + <b>R</b>) foxes.
Out of those foxes:
<ul>
<li><b>S</b> will make a step forward, moving exactly one unit of distance in the direction they are facing.</li>
<li><b>L</b> will stay in the same place and rotate 90 degrees to the left. (So for example if the original fox was facing the point (1,0), there will be <b>L</b> new foxes facing the point (0,1).)</li>
<li><b>R</b> will stay in the same place and rotate 90 degrees to the right.</li>
</ul>
The score of a fox standing at the point (x,y) is x*y. Note that the score of a fox may be zero or even negative. The total score is the sum of the scores of all foxes on the plane.
You are given the long long <b>n</b> and the ints <b>S</b>, <b>L</b>, and <b>R</b>. Return the total score of all foxes after <b>n</b> steps, modulo 1,000,000,007 (10^9 + 7).</td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>SplittingFoxes</td></tr><tr><td>Method:</td><td>sum</td></tr><tr><td>Parameters:</td><td>long long, int, int, int</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int sum(long long n, int S, int L, int R)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td>&#160;&#160;&#160;&#160;</td></tr><tr><td></td></tr><tr><td colspan="2"><h3>Notes</h3></td></tr><tr><td align="center" valign="top">-</td><td>Note that you should return a number between 0 and 1,000,000,006, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>E.g., if the answer is -1, you should return 1,000,000,006 instead of -1.</td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>n</b> will be between 1 and 10^18, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>S</b> will be between 0 and 10^9, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>L</b> will be between 0 and 10^9, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>R</b> will be between 0 and 10^9, inclusive.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>58</pre></td></tr><tr><td><pre>2</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>0</pre></td></tr></table></td></tr><tr><td><pre>Returns: 0</pre></td></tr><tr><td><table><tr><td colspan="2"><pre>
After step 1: there are 2^1 foxes at (1, 0),
After step 2: there are 2^2 foxes at (2, 0),
...
After step 58: there are 2^58 foxes at (58, 0).
</pre>
For each fox at (58, 0), her score is 58 * 0 = 0, so the answer is 0.

</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>3</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>0</pre></td></tr></table></td></tr><tr><td><pre>Returns: 1</pre></td></tr><tr><td><table><tr><td colspan="2">There will be 8 foxes at the end. The fox at (1,1) has score 1. Each of the other 7 foxes has score 0.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>5</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>3</pre></td></tr><tr><td><pre>2</pre></td></tr></table></td></tr><tr><td><pre>Returns: 34</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>5</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>2</pre></td></tr><tr><td><pre>3</pre></td></tr></table></td></tr><tr><td><pre>Returns: 999999973</pre></td></tr><tr><td><table><tr><td colspan="2">The answer is (-34) % 1,000,000,007.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>123456789</pre></td></tr><tr><td><pre>987654321</pre></td></tr><tr><td><pre>544</pre></td></tr><tr><td><pre>544</pre></td></tr></table></td></tr><tr><td><pre>Returns: 0</pre></td></tr><tr><td><table><tr><td colspan="2">By symmetry, if <b>L</b> = <b>R</b>, then the answer will be zero.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">5)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>65536</pre></td></tr><tr><td><pre>1024</pre></td></tr><tr><td><pre>512</pre></td></tr><tr><td><pre>4096</pre></td></tr></table></td></tr><tr><td><pre>Returns: 371473914</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
